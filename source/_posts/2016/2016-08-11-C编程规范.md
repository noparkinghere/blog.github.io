---
layout: "post"
title: "C/C++编程规范"
category: "软件应用"
tags:   ""
date: "2016-08-11 00:00"
---

*文章阐述个人使用 C/C++ 的一些命名规范总结，当然现在很多编辑器强大，很多人不再注意这些规范，但由于本人记性较差，加上打字速度较快，所以这套规范虽然繁琐，但还是比较适合我自己的。*

### 1. 命名规范    

#### 1.1 宏定义的命名全部采用大写，中间间隔用_隔开，要求常量名用大写，常量名用英文表达其意思。 当需要由多个单词表示时，单词与单词之间必须采用连字符"_"连接。 

```sh
如：
#define CM_FILE_NOT_FOUND  CMMAKEHR(0X20B) 其中CM表示类别。 
```

#### 1.2 变量的命名规则要求用“匈牙利命名法”。 (即便很冗余且很多时候并没有实际作用，但方便查看，记性差防止跳过去查了就忘的情况)

*这种命名法的出发点是把变量名按：属性+类型+对象描述的顺序组合起来：*

<!-- more -->

- 属性部分：   

```sh
g_ 全局变量	：如一个全局的长型变量定义为g_lFailCount。  
m_ 　类，结构体成员变量
s_ 　静态变量：如一个静态的指针变量定义为s_plPerv_Inst
c_ 　常量： const 的变量 示例：const char* c_szFileName; 
```

- 类型部分：

```sh
bool 用b开头 b标志寄存器 
int 用i  32位开头 iCount 
short  int  16位用n开头 nStepCount 
long  int 用l开头 lSum 
char  用c开头 cCount 
float 用f开头 fAvg 
double 用d开头 dDeta 
unsigned  char / byte(字节) 用by开头 
unsigned  int(WORD) 用w开头 wCount 
unsigned  long  int(DWORD) 用dw开头 dwBroad 
字符串 用s开头 sFileName 
用0结尾的字符串 用sz开头 szFileName 
指针数组跟着上面类型之前：
数组 a：如一个short int型数组应该表示为anStat。
指针 p：
对一重指针变量的基本原则为：“p”+变量类型前缀+命名，如一个float*型应该表示为pfStat。对二重指针变量的基本规则为：“pp”+变量类型前缀+命名。对三重指针变量的基本规则为：“ppp”+变量类型前缀+命名。 
```

- 描述部分：

```sh
最大　Max		最小　Min		初始化　Init		临时变量　T（或Temp）
源对象　Src		目的对象　Dest
```

#### 1.3 枚举型命名类型名采用驼峰命名法，前面加EM前缀，其中的变量采用 EM_+ 大写字母类似宏定义的形式，申明为枚举型的变量使用以 em 为头的驼峰式命名(枚举变量本身就类似于常量)。

```sh
如： 
enum EMDays 
{ 
	EM_DAYS_MONDAY; 
	EM_DAYS_TUESDAY; 
	…… 
}; 
EMDays  emToday;
```

#### 1.4 结构体、类、共用体的命名规则统一采用大驼峰式（帕斯克命名法），结构体类型定义时在前面需要加上 stru 前缀，结构体变量初始化申明的时候直接采用大驼峰式即可，其成员变量统一加 m_ 不允许使用任何下划线。（函数与结构体变量方便区分，固都采用大驼峰式）

```sh
如：
typedef struct
{ 
	char *m_pcNodeNext;
char *m_pcNodePreview;
}struStudentNode; 
struStudentNode  StudentNode;
```

#### 1.5 函数的命名规则一般采用大驼峰式，命名采用“主动宾”或者“动宾”结构，与结构体变量虽然同样采用大驼峰式，但通过使用方法和命名方便进行区分。同时部分特殊函数可以采用其他命名规则，如`NVIC_Configuration，init_I2C，delay_us 硬件设备相关的使用下划线`，以此来区分哪些是特殊函数（函数与结构体方便区分采用大驼峰式）

**函数参数命名规范 :**

- 参数名称的命名参照变量命名规范。
- 为了提高程序的运行效率，减少参数占用的堆栈，传递大结构的参数，一律采用指针或引用方式传递。
- 为了便于其他程序员识别某个指针参数是入口参数还是出口参数，同时便于编译器检查错误，应该在入口参数前加入const标志。 

```sh
如：
int CmCopyString(const char * c_pcSource, char* pcDest) 
{
...
}
```

- 普通函数与中断调用函数区别命名，普通函数如果需要设定控制终中断函数则命名以Set开头通过修改中断函数中的全局变量判定条件来控制中断执行，而中断功能函数只能被中断调用，不可直接被普通函数调用(包括主函数)，命名以 Run 开头。

#### 1.6 硬件设备名称函数命名参考 stm32 固件库命名法则：外设名称在前面全部大写

```sh
如：
void NVIC_PriorityGroupConfig(uint32_t NVIC_PriorityGroup)
{
	/* Check the parameters */
	assert_param(IS_NVIC_PRIORITY_GROUP(NVIC_PriorityGroup));

	/* Set the PRIGROUP[10:8] bits according to NVIC_PriorityGroup value */
	SCB->AIRCR = AIRCR_VECTKEY_MASK | NVIC_PriorityGroup;
}
```

#### 1.7 文件名(包括动态库、组件、控件、工程文件等)的命名规范,文件名的命名要求表达出文件的内容:要求文件名的长度不得少于5个字母，严禁使用象 file1,myfile 之类的文件名，多个具体含义的单词中用_隔开，一般都采用小写。 

#### 1.8 除了编译开关/头文件等特殊应用，应避免使用 _EXAMPLE_TEST_ 之类以下划线开始和结尾的定义。

### 2 注释规范

#### 2.1 文件注释：(使用/*...*/整体注释，不得采用//行注释)

*格式：*

```sh
/********************* Copyright(C)  20xx  company********************
	File name: 	// 文件名
	Author: 		// 作者、
	Version:		// 版本
	Date: 		// 完成日期
	Description: 	// 用于详细说明此程序文件完成的主要功能，与其他模块
				// 或函数的接口，输出值、取值范围、含义及参数间的控
				// 制、顺序、独立或依赖等关系
	Others: 		// 其它内容的说明
	Function List: // 主要函数列表，每条记录应包括函数名及功能简要说明
					1. ....
	History: 	// 修改历史记录列表，每条修改记录应包括修改日期、修改
				// 者及修改内容简述
	<author> 		<time>	 	<version > 		<desc>
	Name1			20xx.x.x		Vx.x		//修改的内容

*************************************************/
```

*例：*

```sh
/************************************ Copyright (C)  2015  HS ***********************************
	File name：    	channel.c
	Author: 		name
	version:			V1.0
	Description:		实现多个通道的脉冲发送
	Others:
	Function List:
					void GetChanCtrl(void);
					void SetNormalMode(void);
					void SetImMode(void);
					void CtrlPulse(u8 g_byComRev);
					void SetTimeMode(void);
					u16 ScanfValue(void);
					u32 ScanfTime(void);
					void CtrlChannel(void);
					void InitChannel(void);
					void RunNormal(void);
					void RunPulse(void);
					void RunMode(void);
	History:
	<author> 		<time>	 	<version > 		<desc>
Name1			2015.6.1		V1.1		修复xx问题
**************************************************************************************************/
```

#### 2.2 函数注释：(使用/*...*/整体注释，不得采用//行注释)

*格式：*

```sh
/**************************************************************************
	Function: 		// 函数名称
	Description: 		// 函数功能、性能等的描述
	Calls: 			// 被本函数调用的函数清单
	Called By:		 	// 调用本函数的函数清单
	Table Accessed: 	// 被访问的表（此项仅对于牵扯到数据库操作的程序）
	Table Updated: 	// 被修改的表（此项仅对于牵扯到数据库操作的程序）
	Input: 			// 输入参数说明，包括每个参数的作
					// 用、取值说明及参数间关系。
	Output: 			// 对输出参数的说明。
	Return: 			// 函数返回值的说明
	Others: 			// 其它说明
**************************************************************************/
```

*例：*

```sh
/**************************************************************************
	Function: 		InitChannel
	Description: 		启动初始化所有通道
	Calls: 			TIM_DeInit
					TIM3_Int_Init
	Called By:			main()
	Input: 			无
	Output: 			让所有通道输出低电平
	Return: 			无
************************************************************************/
```

#### 2.3 程序块注释：

*一般的程序块注释如 for，while 之类的注释在前面，程序排版整齐，并方便注释的阅读与理解，将注释与其上面的代码用空一行隔开，且该程序块与下面的代码也应该用空一行(使用/\*...\*/整体注释，不得采用//行注释)*

```sh
例：
void example_fun( void )
{
	/* code one comments */
	CodeBlock One

	/* code two comments */
	CodeBlock Two

	/* code three comments */
	CodeBlock Three
}
```

#### 2.4 边写代码边注释，修改代码同时修改相应的注释，以保证注释与代码的一致性。不再有用的注释要删除。命名一般要采用自注释的命名规则(详见命名规范),在需要注释的变量以及函数调用后加注释使用//，无需空行。
