---
layout: "post"
title: "accessport问题总结"
category: "软件应用"
tags:   ""
date: "2017-03-21 10:56"
---

### 简介

AccessPort 是一款用于 PC 机串口(RS232)调试、监控的软件，作用于驱动层之前，可以和其他串口工具同时使用，监控串口的通讯数据。特点：
- 监控串口：具有端口监控功能，可以监控、拦截、保存所收发的数据（ NT/2K/XP/Vista/Win7）。
- 串口调试：支持常用的串口操作功能，支持大数据量的收发、保存，支持自动发送。
- 动态变参：在不改变当前所打开端口的情况下，能动态改变端口参数（如：波特率、校验位、流控制等）。
- 双模编辑：数据发送区内嵌十六进制编辑器（类似 UltraEdit），支持十六进制<=>文本双模式切换编辑，支持 unicode。
- 国际版本：国际版，支持多国语言。
- 无需安装：界面友好，方便易用。

<!-- more -->

### 功能

- 用于串口调试，支持常用的 110-256000 波特率，支持自定义波特率。
- 能以字符或十六进制接收或发送任何数据，能发送、接收任意大小的文件。
- 在不改变当前所打开端口的情况下，能动态改变端口参数（如：波特率、校验位、流控
制等）。
- 数据发送区可实时编辑、发送文本数据。
- 能将所接收的原始数据以及显示数据分别保存。
- 数据发送区允许设置发送周期，自动发送数据。
- 可调试的端口范围是 COM1-COM255，支持扩展端口(USB<->RS232)。
- 可设置字体、文字颜色、背景颜色。
- 允许将发送区的数据在接收区回显，模拟终端操作。
- 允许发送区数据以回车键作为发送操作信号。
- Terminal 模式支持自动应答功能，支持 Hex、 Text、浮点数等类型。
- Terminal 模式支持预定义数据发送，支持 Hex、 Text、浮点数等类型。
- Monitor 模式支持彩色文本显示,便于更好的区分、观察数据.
- 允许 Monitor 模式下拦截到的数据以十六进制或字符方式显示。
- 允许接收区在接收到的数据后添加回车字符(CRLF)，便于观察数据。
- 可将 Terminal 模式下接收到的数据按照十六进制文本方式导出到文件或剪贴板。
- 允许保存程序环境变量。
- 定义热键，方便操作。
- 国际版，支持多国语言。
- 数据发送区内嵌十六进制编辑器，支持 unicode。
- 支持串口监控功能，可以监控串口设置以及收发的数据。
- 在线自动更新提示功能，当有可用新版本时提示用户下载。
- 本程序线程安全，可以同时启动多个副本调试多个串口。

### 使用

AccessPort 通常不作为串口调试工具使用，虽然你也可以直接用该软件来监控串口数据，但一般因为 AccessPort 可以运行在驱动层之上，所以往往我们用 AccessPort 来监控你上位机软件调用驱动的一些操作。AccessPort 本身不会占用串口，因为它不会像其他串口工具一样去进行数据收发，而仅作为监控你驱动层被调用的一种工具。

一般而言需要先开启 AccessPort 的监控功能，然后再开启你的上位机软件，这样 AccessPort 才可以监控你的软件。

### 注意

关闭 AccessPort 需要格外的小心，说白了 AccessPort 类似通过某种不合法的途径来获取你正常软件调用驱动时的状态，因此会有系统崩溃蓝屏的风险，注意做好数据备份。

值得注意的是，停止 AccessPort 监控或者关闭该软件时会可能系统崩溃，**一般串口链接了设备，并打开了 AccessPort 启用了该串口时；如果未在 AccessPort 下关闭该串口或者关闭 AccessPort，而直接移除了该串口的外设的话，则会导致系统崩溃，这种情况下即便再接上该设备或关闭 AccessPort 已经无法补救。**

这时，你需要注意软件关闭的先后顺序，一般我们可以试下以下几种方法：

- 插入串口/usb 前，关闭 AccessPort 。
- 拔掉串口/usb 前，关闭 AccessPort 。
- 先关闭上位机软件串口，再关闭 AccessPort 。
- 最后移除串口外设。

以上几种方式，需要逐一尝试，不同的电脑出现的情况不同，但基本是上面中的某一种/几种情况不会发生系统崩溃，具体原因据称可能是根据你使用的 usb 转串口的驱动（不同的 usb 转换芯片有不同的驱动）有关系。

windows 7 电脑上关闭时步骤：先关闭串口，并退出所有上位机软件，然后 Accessport 停止监控，**最后移除串口外设**。
